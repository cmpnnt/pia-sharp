<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>PIA Sharp | PIA Sharp </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="PIA Sharp | PIA Sharp ">
      
      
      <link rel="icon" href="images/favicon.ico">
      <link rel="stylesheet" href="public/docfx.min.css">
      <link rel="stylesheet" href="public/main.css">
      <meta name="docfx:navrel" content="toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="">
      
      
      <meta name="docfx:docurl" content="https://github.com/cmpnnt/pia-sharp/blob/main/docfx_project/index.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="index.html">
            <img id="logo" class="svg" src="images/logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">

      <div class="content">
        <div class="actionbar">

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="pia-sharp">PIA Sharp</h1>

<p>For basic installation instructions, see the <a href="https://github.com/cmpnnt/pia-sharp#readme">main readme</a>.</p>
<h2 id="compatibility">Compatibility</h2>
<p>PIA Sharp's main package, <code>Cmpnnt.Pia.Ctl</code>, has been tested against version <code>3.3.1</code> on Windows and Linux (MacOS compatibility is on the roadmap).
It provides access to every <code>piactl</code> command available in those version on those systems. It might also work on other
versions of <code>piactl</code>, provided they expose the same commands with the same parameters. However, this hasn't
been tested and nothing is guaranteed.</p>
<h2 id="setup">Setup</h2>
<p>You must have a Private Internet Access account and the <code>piactl</code> command line application installed on your system.
This is included with their desktop GUI application.</p>
<p>There are two ways to use <code>Cmpnnt.Pia.Ctl</code>: <a href="#dependency-injection">Dependency Injection</a> and simple <a href="#instantiation">instantiation</a></p>
<h3 id="dependency-injection">Dependency Injection</h3>
<p>There's a separate dependency injection library you can use if you require DI. Add a reference to
<a href="https://nuget.org/packages/cmpnnt.pia.dependencyinjection">Cmpnnt.Pia.DependencyInjection</a> and include it in your DI container by adding
a call to <code>services.AddPiaCtl()</code> under <code>ConfigureServices</code>.</p>
<div class="NOTE">
<h5>Note</h5>
<p>Note: The dependency injection package registers <code>PiaCtl</code> as a singleton.</p>
</div>
<p>Here's a basic example. You can find the runnable code in the <a href="https://github.com/cmpnnt/pia-sharp/tree/main/Cmpnnt.Pia.Examples">examples project</a>.</p>
<pre><code class="lang-csharp">using IHost host = Host.CreateDefaultBuilder(args)
    .ConfigureServices(services =&gt;
    {
        services.AddPiaCtl();
        services.AddScoped&lt;SomeClass&gt;();
    })
    .ConfigureLogging(options =&gt;
    {
        options.ClearProviders();
        options.AddConsole();
    })
    .Build();
</code></pre>
<h4 id="configuration">Configuration</h4>
<p>You can also pass a lambda function to <code>AddPiaCtl</code> to configure the path to your system's <code>piactl</code> application, if it differs
from the default. On Windows, the default location is <code>C:\Program Files\Private Internet Access\piactl.exe</code>.</p>
<pre><code class="lang-csharp">using IHost host = Host.CreateDefaultBuilder(args)
    .ConfigureServices(services =&gt;
    {
        services.AddPiaCtl(options =&gt;
        {
            options.PiaPath = @&quot;C:\path\to\piactl.exe&quot;;
        });
        services.AddScoped&lt;SomeClass&gt;();
    })
    .ConfigureLogging(options =&gt;
    {
        options.ClearProviders();
        options.AddConsole();
    })
    .Build();
</code></pre>
<h3 id="instantiation">Instantiation</h3>
<p>If you don't need DI, you can use the command-line wrapper by itself by including a reference to <code>Cmpnnt.Pia.Ctl</code>, available as a
<a href="https://nuget.org/packages/cmpnnt.pia.ctl">nuget package</a>.</p>
<pre><code class="lang-csharp">PiaCtl pia = new PiaCtl();
PiaResults results = await pia.GetRegions();
Console.WriteLine(results);
</code></pre>
<h2 id="usage">Usage</h2>
<p>Full API documentation is available in the <a href="api/index.html">API Reference</a>.</p>
<h3 id="commands">Commands</h3>
<blockquote>
<p>TODO: Add link to developer documentation</p>
</blockquote>
<p><code>Cmpnnt.Pia.Ctl</code> allows access to every command exposed by <code>piactl</code>. The methods are all asynchronous, but don't include the <code>async</code> suffix.
The available commands are as follows. See <a href="http://todo">the API reference</a> for detailed developer documentation.</p>
<h3 id="results-command-line-output">Results (command line output)</h3>
<p>All <code>PiaCtl</code> commands return a <code>Task&lt;PiaResults&gt;</code>, which contains a <code>Status</code> enum indicating the result of the operation and a <code>List&lt;string&gt;</code>
for each of stdout and stderr output. The <code>ToString()</code> method has been overridden to return a JSON-formatted string with that information
(using source generation for the JSON serialization).</p>
<h2 id="compiling">Compiling</h2>
<p>Because <code>Cmpnnt.Pia.Ctl</code> is a .NET 7 Native AOT library, it requires additional tooling to compile.</p>
<h3 id="windows">Windows</h3>
<p>On <em>Windows</em>, install
<a href="http://visualstudio.com">Visual Studio 2022</a> with the Desktop Development for C++ workload.</p>
<h3 id="linux">Linux</h3>
<p>On <em>Linux</em>, install the following packages, depending on your distribution:</p>
<p>Ubuntu 18.04+</p>
<pre><code class="lang-shell">sudo apt-get install clang zlib1g-dev
</code></pre>
<p>Alpine 3.15+</p>
<pre><code class="lang-shell">sudo apk add clang build-base zlib-dev
</code></pre>
<h3 id="macos">MacOS</h3>
<p>To compile on MacOS, you'll need to install the latest <a href="https://developer.apple.com/download/">Command Line Tools for XCode</a>.</p>
<h2 id="references">References</h2>
<p>Links to various articles and documentation referenced while building this project can be found <a href="articles/references.html">here</a></p>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/cmpnnt/pia-sharp/blob/main/docfx_project/index.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
